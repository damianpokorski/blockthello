!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).game=e()}}(function(){return function o(s,a,l){function u(t,e){if(!a[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=a[t]={exports:{}};s[t][0].call(r.exports,function(e){return u(s[t][1][e]||e)},r,r.exports,o,s,a,l)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,n){"use strict";var i,r=e("./tile"),a=(i=r)&&i.__esModule?i:{default:i};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.style={},this.game={players:[{name:"White",score:0},{name:"Black",score:0}],turn:0,grid:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,2,1,0,0,0],[0,0,0,1,2,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],directions:[new a.default(-1,-1),new a.default(0,-1),new a.default(1,-1),new a.default(-1,0),new a.default(1,0),new a.default(-1,1),new a.default(0,1),new a.default(1,1)]},this._dimensions=null}var t,n,i;return t=e,(n=[{key:"setup",value:function(){this.style={bg:[color("#574AE2"),color("#222A68")],fg:color("#654597"),highlight:color("#AB81CD"),light:color("#E2ADF2"),white:color("#FFAAAA"),text:color("#FFFFFF"),block:{0:color("#FFFFFF33"),1:color("#FFF"),2:color("#000")}},noStroke(),createCanvas(window.innerWidth,window.innerHeight),this.drawGrid()}},{key:"dimensions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:9,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16;return this._dimensions||(this._dimensions={w:window.innerHeight/t*e,h:window.innerHeight,x:(window.innerWidth-window.innerHeight/t*e)/2,y:0}),this._dimensions}},{key:"dimensionsPercentX",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.dimensions().x+this.dimensions().w/100*e}},{key:"dimensionsPercentY",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.dimensions().y+this.dimensions().h/100*e}},{key:"dimensionsPercent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return{x:this.dimensionsPercentX(e),y:this.dimensionsPercentY(t)}}},{key:"drawPortrait",value:function(){fill(this.style.bg[1]),rect(this.dimensions().x,this.dimensions().y,this.dimensions().w,this.dimensions().h)}},{key:"getScore",value:function(){return this.game.players[0].score.toString()+" - "+this.game.players[1].score.toString()}},{key:"getCurrentPlayer",value:function(){return 0==this.game.turn?"White":"Black"}},{key:"drawScoreboard",value:function(){fill(this.style.text),textSize(this.dimensionsPercent(0,10).y/2),textAlign(LEFT),text(this.game.players[0].name,this.dimensionsPercentX(10),this.dimensionsPercentY(5)),textAlign(RIGHT),text(this.game.players[1].name,this.dimensionsPercentX(90),this.dimensionsPercentY(5)),textAlign(CENTER),text(this.getScore(),this.dimensionsPercentX(50),this.dimensionsPercentY(5)),textSize(this.dimensionsPercent(0,10).y/4),text("".concat(this.getCurrentPlayer(),"s turn"),this.dimensionsPercentX(50),this.dimensionsPercentY(10))}},{key:"gridBlockPosition",value:function(e,t){var n=this.dimensionsPercentY(10),i=this.dimensions().w/8;return{x:this.dimensions().x+e*i+i/8/2,y:this.dimensions().y+t*i+i/8/2+n,w:i-i/8*1,h:i-i/8*1}}},{key:"drawGrid",value:function(){var r=this;fill(this.style.white),this.game.grid.forEach(function(e,i){return e.forEach(function(e,t){var n=r.gridBlockPosition(t,i);fill(r.style.block[e]),rect(n.x,n.y,n.w,n.h)})})}},{key:"draw",value:function(){clear(),background(this.style.bg[0]),this.drawPortrait(),this.drawScoreboard(),this.drawGrid()}},{key:"updateScore",value:function(){var n=0,i=0;this.game.grid.forEach(function(e,t){return e.forEach(function(e,t){1==e&&n++,2==e&&i++})}),this.game.players[0].score=n,this.game.players[1].score=i}},{key:"forEachBlock",value:function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(e,t,n){};this.game.grid.forEach(function(e,n){return e.forEach(function(e,t){i(t,n,e)})})}},{key:"blockClicked",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new a.default;null==this.getTileState(e)&&(this.game.grid[e.y][e.x]=1+this.game.turn,0<this.blocksFlippedByPlacingTile(e).length?(this.processChanges(e),this.game.turn=0==this.game.turn?1:0):this.game.grid[e.y][e.x]=0)}},{key:"touched",value:function(){var r=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.game.grid.forEach(function(e,i){return e.forEach(function(e,t){var n=r.gridBlockPosition(t,i);o>n.x&&o<n.x+n.w&&s>n.y&&s<n.y+n.h&&r.hasAdjecent(new a.default(t,i))&&r.blockClicked(new a.default(t,i))})})}},{key:"getTileState",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new a.default;if(!e.isValid())return null;switch(this.game.grid[e.y][e.x]){case 0:return null;case 1:return this.game.players[0].name;case 2:return this.game.players[1].name}}},{key:"filterDirection",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new a.default,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new a.default;return(0,arguments[2])({x:e.x+t.x,y:e.y+t.y})}},{key:"blocksFlippedByPlacingTile",value:function(){var i=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new a.default,o=[];return this.game.directions.forEach(function(e){for(var t=[],n=e;null!==i.getTileState(r.add(n))&&i.getTileState(r.add(n))!=i.getTileState(r);)t.push(r.add(n)),n=n.add(e);i.getTileState(r)==i.getTileState(r.add(n))&&(o=o.concat(t))}),o}},{key:"processChanges",value:function(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new a.default;this.blocksFlippedByPlacingTile(e).forEach(function(e,t){var n=o.game.turn,i=e.x,r=e.y;o.game.grid[r][i]=1+n,o.updateScore()})}},{key:"hasAdjecent",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new a.default;return this.game.directions.some(function(e){return null!==t.getTileState(n.add(e))})}}])&&o(t.prototype,n),i&&o(t,i),e}();t.exports=new s},{"./tile":3}],2:[function(e,t,n){"use strict";t.exports=e("./game.js")},{"./game.js":1}],3:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.x=e,this.y=t,this.max_x=7,this.max_y=7,this.min_x=0,this.min_y=0}var e,t,i;return e=n,(t=[{key:"isValid",value:function(){return this.x>=this.min_x&&this.x<=this.max_x&&this.y>=this.min_y&&this.y<=this.max_y}},{key:"add",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new n;return new n(this.x+e.x,this.y+e.y)}},{key:"substract",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new n;return new n(this.x-e.x,this.y-e.y)}}])&&r(e.prototype,t),i&&r(e,i),n}();t.exports=i},{}]},{},[2])(2)});
